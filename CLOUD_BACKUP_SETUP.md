# ☁️ クラウドバックアップ設定ガイド

TalkFridge のデータを自動的に Google スプレッドシートや Notion にバックアップする方法です。

---

## 🔧 Google スプレッドシート連携

### 1. スプレッドシートを作成

1. [Google スプレッドシート](https://sheets.google.com) を開く
2. 新しいスプレッドシートを作成
3. スプレッドシート ID をコピー（URL の `/d/` と `/edit` の間の文字列）

**例：**

```
https://docs.google.com/spreadsheets/d/ABC123XYZ456/edit
                                        ↑これがスプレッドシートID
```

### 2. Google Cloud Console で API キーを取得

1. [Google Cloud Console](https://console.cloud.google.com/) にアクセス
2. プロジェクトを作成（または既存のプロジェクトを選択）
3. 「API とサービス」→「ライブラリ」→「Google Sheets API」を有効化
4. 「API とサービス」→「認証情報」→「認証情報を作成」→「API キー」
5. API キーをコピー

### 3. アプリで設定

1. 「食べた歴史」タブを開く
2. 「⚙️ 設定」をクリック
3. サービスを「Google スプレッドシート」に選択
4. API キーとスプレッドシート ID を入力
5. 設定を保存

### 4. スプレッドシートの共有設定（重要）

作成したスプレッドシートを「リンクを知っている全員」に編集権限を付与するか、API キーを使ってアクセスできるように設定する必要があります。

---

## 📝 Notion 連携

### 1. Notion インテグレーションを作成

1. [Notion Integrations](https://www.notion.so/my-integrations) にアクセス
2. 「+ New integration」をクリック
3. 名前を入力（例：「TalkFridge」）
4. 「Internal Integration」を選択
5. 「Submit」をクリック
6. **Internal Integration Token** をコピー（これが API キー）

### 2. データベースを作成

1. Notion で新しいページを作成
2. 「/」と入力して「Table」を選択
3. 列を追加：
   - 食材名（タイトル）
   - 数量（数値）
   - 単位（テキスト）
   - カテゴリ（選択肢）
   - 登録日（日付）

### 3. データベースをインテグレーションに接続

1. データベースの「...」メニューをクリック
2. 「Connections」→ 作成したインテグレーションを選択
3. データベース ID をコピー（URL の最後の部分）

**例：**

```
https://www.notion.so/workspace/ABC123XYZ456
                                      ↑これがデータベースID
```

### 4. アプリで設定

1. 「食べた歴史」タブを開く
2. 「⚙️ 設定」をクリック
3. サービスを「Notion」に選択
4. API キー（Internal Integration Token）とデータベース ID を入力
5. 設定を保存

---

## 🔄 自動バックアップ

設定後、食材を追加すると自動的にクラウドにバックアップされます。

- **手動バックアップ**: 「🔄 今すぐバックアップ」ボタンをクリック

---

## ⚠️ 注意事項

1. **API キーのセキュリティ**

   - API キーはブラウザの localStorage に保存されます
   - 暗号化されていないため、個人利用のみ推奨
   - 共有のコンピューターでは使用しないでください

2. **無料枠**

   - Google Sheets API: 1 分あたり 100 リクエスト（個人利用なら十分）
   - Notion API: 月間 3 リクエスト/秒（個人利用なら十分）

3. **データ形式**
   - 現在は食材情報のみバックアップ（レシピ履歴・使用履歴は今後追加予定）

---

## 🚀 より安全な方法（将来実装予定）

- OAuth 認証（API キー不要）
- 暗号化されたバックアップ
- 自動定期的バックアップ
- 複数のバックアップ先の選択

